// Generated by CoffeeScript 1.7.1
(function() {
  var WheelOfFortune;

  document.addEventListener("DOMContentLoaded", function() {
    var animation;
    return animation = new WheelOfFortune(details);
  });

  WheelOfFortune = (function() {
    WheelOfFortune.prototype.last = 0;

    function WheelOfFortune(details) {
      this.slideIndex = 0;
      this.details = details;
      this.firstSlide = document.getElementsByClassName("slide1");
      this.secondSlide = document.getElementsByClassName("slide2");
      this.setSlides();
      this.animate = setInterval(this.rotation, 20, this);
    }

    WheelOfFortune.prototype.rotation = function(WheelOfFortune) {
      var waitTime;
      waitTime = 100;
      if (WheelOfFortune.last > waitTime) {
        WheelOfFortune.firstSlide[0].style.MozTransform = "rotate(-" + ((WheelOfFortune.last - waitTime) / 10) + "deg)";
        WheelOfFortune.secondSlide[0].style.MozTransform = "rotate(" + (30 - ((WheelOfFortune.last - waitTime) / 10)) + "deg)";
      }
      WheelOfFortune.last += 1;
      if (WheelOfFortune.last > 300 + waitTime) {
        WheelOfFortune.setSlides();
        WheelOfFortune.resetSlidesPosition();
        return WheelOfFortune.last = 0;
      }
    };

    WheelOfFortune.prototype.setSlides = function() {
      if (this.slideIndex < (this.details.length - 2)) {
        document.querySelector('.slide1>h2').innerHTML = this.details[this.slideIndex].titre;
        this.setSlide(document.querySelector('.slide1>p'), this.details[this.slideIndex]);
        this.setSlideImage(document.querySelector('.slide1>img'), this.details[this.slideIndex]);
        document.querySelector('.slide2>h2').innerHTML = this.details[this.slideIndex + 1].titre;
        this.setSlide(document.querySelector('.slide2>p'), this.details[this.slideIndex + 1]);
        this.setSlideImage(document.querySelector('.slide2>img'), this.details[this.slideIndex + 1]);
        return this.slideIndex += 1;
      } else {
        return clearInterval(this.animate);
      }
    };

    WheelOfFortune.prototype.setSlide = function(element, details) {
      element.innerHTML = "";
      if (details.texte != null) {
        return element.innerHTML = details.texte;
      }
    };

    WheelOfFortune.prototype.setSlideImage = function(element, details) {
      var _categorie;
      _categorie = {
        "musique": "circlecornet.gif",
        "culinaire": "cake.gif",
        "personne": "abolla.gif",
        "divers": "goniometer.gif"
      };
      if (_categorie[details.categorie] != null) {
        return element.src = "/public/img/" + _categorie[details.categorie];
      } else {
        return element.src = "/public/img/armadillo.gif";
      }
    };

    WheelOfFortune.prototype.resetSlidesPosition = function() {
      this.firstSlide[0].style.MozTransform = "rotate(0deg)";
      return this.secondSlide[0].style.MozTransform = "rotate(30deg)";
    };

    return WheelOfFortune;

  })();

}).call(this);
